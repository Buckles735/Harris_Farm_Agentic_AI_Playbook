<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harris Farm Markets ‚Äî Internal Workflow Agent</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap');

  :root {
    --dark-green: #1B4332;
    --med-green: #2D6A4F;
    --light-green: #40916C;
    --accent: #52B788;
    --gold: #D4A843;
    --off-white: #F5F7F0;
    --cream: #EDF2E4;
    --dark-text: #1A1A2E;
    --muted: #5A6B5D;
    --card-bg: #FFFFFF;
    --red: #E74C3C;
    --orange: #F39C12;
    --blue: #3498DB;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Inter', sans-serif; background: var(--off-white); color: var(--dark-text); min-height: 100vh; }

  /* Layout */
  .app { display: flex; height: 100vh; }
  .sidebar { width: 260px; background: var(--dark-green); color: white; display: flex; flex-direction: column; flex-shrink: 0; }
  .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
  .topbar { background: white; border-bottom: 1px solid #e0e5d8; padding: 12px 28px; display: flex; align-items: center; justify-content: space-between; }
  .content { flex: 1; overflow-y: auto; padding: 24px 28px; }

  /* Sidebar */
  .sidebar-header { padding: 20px 18px; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .sidebar-header h1 { font-family: 'Playfair Display', serif; font-size: 18px; font-weight: 700; }
  .sidebar-header .subtitle { font-size: 11px; color: var(--accent); margin-top: 2px; letter-spacing: 0.5px; text-transform: uppercase; }
  .sidebar-nav { padding: 12px 0; flex: 1; }
  .nav-section { padding: 6px 18px; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: rgba(255,255,255,0.4); margin-top: 12px; }
  .nav-item { display: flex; align-items: center; gap: 10px; padding: 10px 18px; cursor: pointer; font-size: 13px; color: rgba(255,255,255,0.7); transition: all 0.15s; border-left: 3px solid transparent; }
  .nav-item:hover { background: rgba(255,255,255,0.07); color: white; }
  .nav-item.active { background: rgba(82,183,136,0.15); color: var(--accent); border-left-color: var(--accent); font-weight: 500; }
  .nav-icon { width: 18px; text-align: center; font-size: 14px; }
  .nav-badge { margin-left: auto; background: var(--red); color: white; font-size: 10px; padding: 1px 6px; border-radius: 8px; font-weight: 600; }

  /* Agent Status Indicator */
  .agent-status { padding: 14px 18px; border-top: 1px solid rgba(255,255,255,0.1); }
  .agent-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: var(--accent); margin-right: 6px; animation: pulse 2s infinite; }
  @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
  .agent-status-text { font-size: 11px; color: rgba(255,255,255,0.6); }

  /* Topbar */
  .topbar h2 { font-family: 'Playfair Display', serif; font-size: 20px; color: var(--dark-green); font-weight: 600; }
  .topbar-actions { display: flex; gap: 10px; align-items: center; }
  .btn { padding: 7px 16px; border-radius: 6px; border: none; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.15s; display: inline-flex; align-items: center; gap: 6px; }
  .btn-primary { background: var(--accent); color: white; }
  .btn-primary:hover { background: var(--light-green); }
  .btn-outline { background: transparent; border: 1px solid #c8d0c0; color: var(--muted); }
  .btn-outline:hover { border-color: var(--accent); color: var(--dark-green); }
  .store-select { padding: 7px 12px; border: 1px solid #c8d0c0; border-radius: 6px; font-size: 12px; background: white; color: var(--dark-text); }

  /* Dashboard Grid */
  .dash-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
  .stat-card { background: white; border-radius: 10px; padding: 18px; border: 1px solid #e0e5d8; position: relative; overflow: hidden; }
  .stat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
  .stat-card.green::before { background: var(--accent); }
  .stat-card.gold::before { background: var(--gold); }
  .stat-card.red::before { background: var(--red); }
  .stat-card.blue::before { background: var(--blue); }
  .stat-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px; }
  .stat-value { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 700; color: var(--dark-green); }
  .stat-change { font-size: 11px; margin-top: 4px; }
  .stat-change.up { color: var(--accent); }
  .stat-change.down { color: var(--red); }

  /* Two Column */
  .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
  .panel { background: white; border-radius: 10px; border: 1px solid #e0e5d8; overflow: hidden; }
  .panel-header { padding: 14px 18px; border-bottom: 1px solid #e0e5d8; display: flex; align-items: center; justify-content: space-between; }
  .panel-title { font-weight: 600; font-size: 14px; color: var(--dark-green); }
  .panel-body { padding: 14px 18px; }

  /* Task List */
  .task-item { display: flex; align-items: flex-start; gap: 10px; padding: 10px 0; border-bottom: 1px solid #f0f2ec; }
  .task-item:last-child { border-bottom: none; }
  .task-priority { width: 6px; height: 6px; border-radius: 50%; margin-top: 6px; flex-shrink: 0; }
  .task-priority.high { background: var(--red); }
  .task-priority.medium { background: var(--orange); }
  .task-priority.low { background: var(--accent); }
  .task-content { flex: 1; }
  .task-title { font-size: 13px; font-weight: 500; color: var(--dark-text); }
  .task-meta { font-size: 11px; color: var(--muted); margin-top: 2px; }
  .task-badge { font-size: 10px; padding: 2px 8px; border-radius: 4px; font-weight: 500; white-space: nowrap; }
  .badge-urgent { background: #fde8e8; color: var(--red); }
  .badge-auto { background: #e8f5e9; color: var(--light-green); }
  .badge-pending { background: #fef3e0; color: var(--orange); }

  /* Agent Chat */
  .chat-panel { background: white; border-radius: 10px; border: 1px solid #e0e5d8; margin-bottom: 24px; overflow: hidden; }
  .chat-messages { padding: 18px; max-height: 320px; overflow-y: auto; }
  .chat-msg { margin-bottom: 14px; display: flex; gap: 10px; }
  .chat-avatar { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; flex-shrink: 0; }
  .chat-avatar.agent { background: var(--accent); color: white; }
  .chat-avatar.user { background: var(--gold); color: white; }
  .chat-bubble { background: var(--cream); border-radius: 8px; padding: 10px 14px; max-width: 85%; font-size: 13px; line-height: 1.5; }
  .chat-bubble.agent { background: #e8f5e9; }
  .chat-bubble .action-card { background: white; border: 1px solid #d0d8c8; border-radius: 6px; padding: 10px; margin-top: 8px; }
  .chat-bubble .action-card h4 { font-size: 12px; color: var(--dark-green); margin-bottom: 4px; }
  .chat-bubble .action-card p { font-size: 11px; color: var(--muted); }
  .chat-input-area { display: flex; border-top: 1px solid #e0e5d8; }
  .chat-input { flex: 1; border: none; padding: 14px 18px; font-size: 13px; font-family: 'Inter', sans-serif; outline: none; }
  .chat-send { padding: 14px 18px; background: var(--accent); color: white; border: none; cursor: pointer; font-size: 13px; font-weight: 500; transition: background 0.15s; }
  .chat-send:hover { background: var(--light-green); }

  /* Alert Banner */
  .alert-banner { background: linear-gradient(135deg, #fef3e0 0%, #fde8e8 100%); border: 1px solid #f5d0a9; border-radius: 10px; padding: 14px 18px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }
  .alert-icon { font-size: 20px; }
  .alert-content h4 { font-size: 13px; color: var(--dark-text); font-weight: 600; }
  .alert-content p { font-size: 12px; color: var(--muted); margin-top: 2px; }
  .alert-actions { margin-left: auto; display: flex; gap: 8px; }

  /* Waste Tracker */
  .waste-bar { display: flex; height: 24px; border-radius: 6px; overflow: hidden; margin: 8px 0; }
  .waste-segment { display: flex; align-items: center; justify-content: center; font-size: 10px; color: white; font-weight: 500; transition: width 0.5s; }

  /* Timeline */
  .timeline-item { display: flex; gap: 12px; padding: 8px 0; }
  .timeline-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); margin-top: 4px; flex-shrink: 0; }
  .timeline-text { font-size: 12px; color: var(--dark-text); }
  .timeline-time { font-size: 10px; color: var(--muted); }

  /* Typing animation */
  .typing-dots span { animation: blink 1.4s infinite both; display: inline-block; }
  .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
  .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
  @keyframes blink { 0%, 80%, 100% { opacity: 0; } 40% { opacity: 1; } }

  /* Responsive */
  @media (max-width: 1200px) { .dash-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 900px) { .two-col { grid-template-columns: 1fr; } .sidebar { display: none; } }
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h1>Harris Farm</h1>
      <div class="subtitle">Workflow Agent</div>
    </div>
    <div class="sidebar-nav">
      <div class="nav-section">Command Centre</div>
      <div class="nav-item active" onclick="showView('dashboard')">
        <span class="nav-icon">üìä</span> Dashboard
      </div>
      <div class="nav-item" onclick="showView('tasks')">
        <span class="nav-icon">‚úÖ</span> Task Queue <span class="nav-badge">12</span>
      </div>
      <div class="nav-item" onclick="showView('agent')">
        <span class="nav-icon">ü§ñ</span> Agent Chat
      </div>

      <div class="nav-section">Agents</div>
      <div class="nav-item" onclick="showView('waste')">
        <span class="nav-icon">ü•¨</span> Waste Reduction
      </div>
      <div class="nav-item" onclick="showView('scheduling')">
        <span class="nav-icon">üë•</span> Workforce
      </div>
      <div class="nav-item" onclick="showView('supplier')">
        <span class="nav-icon">üöõ</span> Supplier Mgmt
      </div>
      <div class="nav-item" onclick="showView('compliance')">
        <span class="nav-icon">üìã</span> Compliance
      </div>

      <div class="nav-section">Settings</div>
      <div class="nav-item">
        <span class="nav-icon">‚öôÔ∏è</span> Agent Config
      </div>
      <div class="nav-item">
        <span class="nav-icon">üìà</span> Reports
      </div>
    </div>
    <div class="agent-status">
      <span class="agent-dot"></span>
      <span class="agent-status-text">7 agents active across 38 stores</span>
    </div>
  </div>

  <!-- Main -->
  <div class="main">
    <div class="topbar">
      <h2 id="view-title">Store Operations Dashboard</h2>
      <div class="topbar-actions">
        <select class="store-select" id="storeSelect" onchange="updateStore()">
          <option>All Stores (38)</option>
          <option>Leichhardt</option>
          <option>Drummoyne</option>
          <option>Willoughby</option>
          <option>Redfern</option>
          <option>Marrickville</option>
          <option>Miranda</option>
          <option>Canberra</option>
          <option>Brisbane CBD</option>
        </select>
        <button class="btn btn-outline" onclick="refreshData()">‚Üª Refresh</button>
        <button class="btn btn-primary" onclick="showView('agent')">ü§ñ Ask Agent</button>
      </div>
    </div>

    <div class="content" id="main-content">
      <!-- Dashboard View (default) -->
      <div id="view-dashboard">
        <!-- Alert Banner -->
        <div class="alert-banner">
          <span class="alert-icon">‚ö†Ô∏è</span>
          <div class="alert-content">
            <h4>Agent Alert: Temperature spike detected in Redfern cold room #2</h4>
            <p>Temperature rose to 6.2¬∞C at 8:14am. Agent has notified store manager and adjusted compressor settings. Estimated recovery: 22 minutes.</p>
          </div>
          <div class="alert-actions">
            <button class="btn btn-outline" onclick="dismissAlert(this)">Dismiss</button>
            <button class="btn btn-primary" onclick="showView('compliance')">View Details</button>
          </div>
        </div>

        <!-- Stats -->
        <div class="dash-grid">
          <div class="stat-card green">
            <div class="stat-label">Tasks Auto-Completed Today</div>
            <div class="stat-value" id="stat-tasks">47</div>
            <div class="stat-change up">‚Üë 23% vs. last week</div>
          </div>
          <div class="stat-card gold">
            <div class="stat-label">Waste Saved (This Week)</div>
            <div class="stat-value" id="stat-waste">$18.4K</div>
            <div class="stat-change up">‚Üë 12% vs. target</div>
          </div>
          <div class="stat-card blue">
            <div class="stat-label">Schedule Optimisation</div>
            <div class="stat-value">94%</div>
            <div class="stat-change up">‚Üë 8% since deployment</div>
          </div>
          <div class="stat-card red">
            <div class="stat-label">Pending Escalations</div>
            <div class="stat-value" id="stat-escalations">3</div>
            <div class="stat-change down">‚Üì 2 from yesterday</div>
          </div>
        </div>

        <!-- Two Column -->
        <div class="two-col">
          <!-- Active Tasks -->
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">ü§ñ Agent Activity Feed</span>
              <button class="btn btn-outline" style="padding: 4px 10px; font-size: 11px;">View All</button>
            </div>
            <div class="panel-body">
              <div class="task-item">
                <div class="task-priority high"></div>
                <div class="task-content">
                  <div class="task-title">Auto-markdown triggered: 42 items approaching expiry at Drummoyne</div>
                  <div class="task-meta">Waste Agent ‚Ä¢ 3 min ago ‚Ä¢ Est. recovery: $280</div>
                </div>
                <span class="task-badge badge-auto">Auto</span>
              </div>
              <div class="task-item">
                <div class="task-priority medium"></div>
                <div class="task-content">
                  <div class="task-title">Shift swap approved: Sarah M. ‚Üî James K. for Sat AM at Miranda</div>
                  <div class="task-meta">Workforce Agent ‚Ä¢ 18 min ago</div>
                </div>
                <span class="task-badge badge-auto">Auto</span>
              </div>
              <div class="task-item">
                <div class="task-priority low"></div>
                <div class="task-content">
                  <div class="task-title">Purchase order generated: 340kg seasonal stone fruit from Riverina supplier</div>
                  <div class="task-meta">Supplier Agent ‚Ä¢ 42 min ago</div>
                </div>
                <span class="task-badge badge-auto">Auto</span>
              </div>
              <div class="task-item">
                <div class="task-priority high"></div>
                <div class="task-content">
                  <div class="task-title">Escalation: Amazon fulfilment capacity at 92% ‚Äî recommend activating Leichhardt backup</div>
                  <div class="task-meta">Fulfilment Agent ‚Ä¢ 1 hr ago</div>
                </div>
                <span class="task-badge badge-urgent">Needs Review</span>
              </div>
              <div class="task-item">
                <div class="task-priority low"></div>
                <div class="task-content">
                  <div class="task-title">Compliance: All 38 stores passed morning temperature audit</div>
                  <div class="task-meta">Compliance Agent ‚Ä¢ 2 hrs ago</div>
                </div>
                <span class="task-badge badge-auto">Auto</span>
              </div>
            </div>
          </div>

          <!-- Agent Insights -->
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">üí° Proactive Insights</span>
              <button class="btn btn-outline" style="padding: 4px 10px; font-size: 11px;">Settings</button>
            </div>
            <div class="panel-body">
              <div class="task-item">
                <div class="task-priority high"></div>
                <div class="task-content">
                  <div class="task-title">Demand spike predicted: +35% avocado demand next week (social media trend detected)</div>
                  <div class="task-meta">Forecasting Agent ‚Ä¢ Recommendation: Increase order by 420kg</div>
                </div>
                <span class="task-badge badge-pending">Review</span>
              </div>
              <div class="task-item">
                <div class="task-priority medium"></div>
                <div class="task-content">
                  <div class="task-title">Supplier risk: Berry supplier in QLD reporting 15% crop loss from recent storms</div>
                  <div class="task-meta">Supplier Agent ‚Ä¢ 3 alternate suppliers identified</div>
                </div>
                <span class="task-badge badge-pending">Review</span>
              </div>
              <div class="task-item">
                <div class="task-priority low"></div>
                <div class="task-content">
                  <div class="task-title">Staffing gap found: Marrickville under-rostered for projected Sat foot traffic by 2 FTEs</div>
                  <div class="task-meta">Workforce Agent ‚Ä¢ 4 available casual staff matched</div>
                </div>
                <span class="task-badge badge-pending">Review</span>
              </div>
              <div class="task-item">
                <div class="task-priority low"></div>
                <div class="task-content">
                  <div class="task-title">Pricing opportunity: Competitor Woolworths increased mango prices by 18% this week</div>
                  <div class="task-meta">Pricing Agent ‚Ä¢ Potential margin uplift: $4,200/week</div>
                </div>
                <span class="task-badge badge-pending">Review</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Agent Chat View -->
      <div id="view-agent" style="display:none;">
        <div class="chat-panel">
          <div class="panel-header">
            <span class="panel-title">ü§ñ Harris Farm Workflow Agent</span>
            <span style="font-size: 11px; color: var(--muted);">Powered by Agentic AI ‚Ä¢ Connected to all systems</span>
          </div>
          <div class="chat-messages" id="chatMessages">
            <div class="chat-msg">
              <div class="chat-avatar agent">AI</div>
              <div class="chat-bubble agent">
                Good morning! I'm your Harris Farm Workflow Agent. I've completed <strong>47 automated tasks</strong> this morning and have <strong>3 items</strong> that need your review. What would you like to focus on?
                <div class="action-card">
                  <h4>Quick Actions Available</h4>
                  <p>‚Ä¢ Review pending markdowns (42 items) &nbsp; ‚Ä¢ Approve shift swaps (2 pending) &nbsp; ‚Ä¢ Check Amazon fulfilment status &nbsp; ‚Ä¢ Generate weekly waste report</p>
                </div>
              </div>
            </div>
          </div>
          <div class="chat-input-area">
            <input class="chat-input" id="chatInput" placeholder="Ask the agent anything... e.g. 'What's the waste trend at Miranda this month?'" onkeypress="if(event.key==='Enter')sendMessage()">
            <button class="chat-send" onclick="sendMessage()">Send ‚Üí</button>
          </div>
        </div>

        <!-- Suggested queries -->
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button class="btn btn-outline" onclick="askPreset('Show me today\'s waste reduction savings across all stores')">üìä Today's waste savings</button>
          <button class="btn btn-outline" onclick="askPreset('Which stores are understaffed this weekend?')">üë• Weekend staffing gaps</button>
          <button class="btn btn-outline" onclick="askPreset('What supplier orders need attention?')">üöõ Supplier orders</button>
          <button class="btn btn-outline" onclick="askPreset('Generate a morning briefing for leadership')">üìã Leadership briefing</button>
          <button class="btn btn-outline" onclick="askPreset('What\'s our Amazon fulfilment performance today?')">üì¶ Amazon fulfilment</button>
        </div>
      </div>

      <!-- Waste Reduction View -->
      <div id="view-waste" style="display:none;">
        <div class="dash-grid" style="grid-template-columns: repeat(3, 1fr);">
          <div class="stat-card green">
            <div class="stat-label">Waste Prevented Today</div>
            <div class="stat-value">$4,230</div>
            <div class="stat-change up">‚Üë 18% vs. avg</div>
          </div>
          <div class="stat-card gold">
            <div class="stat-label">Auto-Markdowns Today</div>
            <div class="stat-value">127</div>
            <div class="stat-change up">Recovery rate: 72%</div>
          </div>
          <div class="stat-card blue">
            <div class="stat-label">Imperfect Picks Routed</div>
            <div class="stat-value">84 kg</div>
            <div class="stat-change up">‚Üë vs. 65 kg target</div>
          </div>
        </div>

        <div class="two-col">
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">ü•¨ Waste Breakdown by Category</span>
            </div>
            <div class="panel-body">
              <div style="margin-bottom: 14px;">
                <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;"><span>Fruit & Vegetables</span><span style="color: var(--accent);">62% recovered</span></div>
                <div class="waste-bar"><div class="waste-segment" style="width: 62%; background: var(--accent);">Sold</div><div class="waste-segment" style="width: 18%; background: var(--gold);">Imperfect</div><div class="waste-segment" style="width: 12%; background: var(--orange);">Charity</div><div class="waste-segment" style="width: 8%; background: var(--red);">Waste</div></div>
              </div>
              <div style="margin-bottom: 14px;">
                <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;"><span>Bakery & Deli</span><span style="color: var(--accent);">54% recovered</span></div>
                <div class="waste-bar"><div class="waste-segment" style="width: 54%; background: var(--accent);">Sold</div><div class="waste-segment" style="width: 8%; background: var(--gold);">Reduced</div><div class="waste-segment" style="width: 22%; background: var(--orange);">Charity</div><div class="waste-segment" style="width: 16%; background: var(--red);">Waste</div></div>
              </div>
              <div style="margin-bottom: 14px;">
                <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;"><span>Meat & Seafood</span><span style="color: var(--accent);">78% recovered</span></div>
                <div class="waste-bar"><div class="waste-segment" style="width: 78%; background: var(--accent);">Sold</div><div class="waste-segment" style="width: 12%; background: var(--gold);">Reduced</div><div class="waste-segment" style="width: 10%; background: var(--red);">Waste</div></div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;"><span>Dairy & Cheese</span><span style="color: var(--accent);">68% recovered</span></div>
                <div class="waste-bar"><div class="waste-segment" style="width: 68%; background: var(--accent);">Sold</div><div class="waste-segment" style="width: 15%; background: var(--gold);">Reduced</div><div class="waste-segment" style="width: 10%; background: var(--orange);">Charity</div><div class="waste-segment" style="width: 7%; background: var(--red);">Waste</div></div>
              </div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">‚è∞ Agent Actions Timeline</span>
            </div>
            <div class="panel-body">
              <div class="timeline-item"><div class="timeline-dot"></div><div><div class="timeline-text">Auto-marked down 42 items at Drummoyne (berries, salad mix, yoghurt)</div><div class="timeline-time">8:47am ‚Äî Est. recovery $280</div></div></div>
              <div class="timeline-item"><div class="timeline-dot"></div><div><div class="timeline-text">Routed 12kg overripe bananas to Imperfect Picks display at Willoughby</div><div class="timeline-time">8:23am ‚Äî Saves $45 vs. waste</div></div></div>
              <div class="timeline-item"><div class="timeline-dot"></div><div><div class="timeline-text">Generated charity pickup request for OzHarvest: 28kg bakery items, Leichhardt</div><div class="timeline-time">7:55am ‚Äî Tax deduction: $120</div></div></div>
              <div class="timeline-item"><div class="timeline-dot"></div><div><div class="timeline-text">Adjusted tomorrow's stone fruit order at Redfern (-15%) based on shelf life model</div><div class="timeline-time">7:30am ‚Äî Prevents ~$340 potential waste</div></div></div>
              <div class="timeline-item"><div class="timeline-dot"></div><div><div class="timeline-text">Flagged: Lettuce supplier batch showing 2-day shorter shelf life than usual</div><div class="timeline-time">6:15am ‚Äî Escalated to buying team</div></div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Scheduling View -->
      <div id="view-scheduling" style="display:none;">
        <div class="dash-grid" style="grid-template-columns: repeat(3, 1fr);">
          <div class="stat-card green">
            <div class="stat-label">Schedule Optimisation Score</div>
            <div class="stat-value">94%</div>
            <div class="stat-change up">‚Üë from 78% pre-agent</div>
          </div>
          <div class="stat-card gold">
            <div class="stat-label">Auto Shift Swaps (This Week)</div>
            <div class="stat-value">23</div>
            <div class="stat-change up">Zero manager intervention</div>
          </div>
          <div class="stat-card blue">
            <div class="stat-label">Labour Cost Savings (MTD)</div>
            <div class="stat-value">$38K</div>
            <div class="stat-change up">‚Üë 14% vs. budget</div>
          </div>
        </div>

        <div class="panel" style="margin-bottom: 20px;">
          <div class="panel-header">
            <span class="panel-title">üë• Workforce Agent ‚Äî This Week's Actions</span>
          </div>
          <div class="panel-body">
            <div class="task-item">
              <div class="task-priority high"></div>
              <div class="task-content"><div class="task-title">Gap filled: Recruited 2 casual staff for Miranda Saturday peak (predicted 40% above avg traffic)</div><div class="task-meta">Auto-matched from talent pool ‚Ä¢ Pending manager confirmation</div></div>
              <span class="task-badge badge-pending">Confirm</span>
            </div>
            <div class="task-item">
              <div class="task-priority medium"></div>
              <div class="task-content"><div class="task-title">Optimised Drummoyne roster: Moved 3 staff from quiet Tuesday PM to busy Wednesday AM</div><div class="task-meta">Based on foot traffic forecast ‚Ä¢ Saves 12 labour hours</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">Award compliance check: All 38 stores compliant with Fair Work break requirements</div><div class="task-meta">Weekly automated audit complete</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
            <div class="task-item">
              <div class="task-priority medium"></div>
              <div class="task-content"><div class="task-title">Training gap identified: 8 new starters need food safety certification within 14 days</div><div class="task-meta">Auto-enrolled in Dayforce learning module</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Supplier View -->
      <div id="view-supplier" style="display:none;">
        <div class="dash-grid" style="grid-template-columns: repeat(3, 1fr);">
          <div class="stat-card green">
            <div class="stat-label">Active Suppliers</div>
            <div class="stat-value">247</div>
            <div class="stat-change up">98% on-time delivery rate</div>
          </div>
          <div class="stat-card gold">
            <div class="stat-label">Auto-Generated POs Today</div>
            <div class="stat-value">34</div>
            <div class="stat-change up">$142K total value</div>
          </div>
          <div class="stat-card red">
            <div class="stat-label">Supplier Alerts</div>
            <div class="stat-value">2</div>
            <div class="stat-change down">QLD berry shortage + dairy delay</div>
          </div>
        </div>

        <div class="panel">
          <div class="panel-header"><span class="panel-title">üöõ Supplier Agent Activity</span></div>
          <div class="panel-body">
            <div class="task-item">
              <div class="task-priority high"></div>
              <div class="task-content"><div class="task-title">Risk alert: QLD berry supplier reporting 15% crop loss ‚Äî 3 backup suppliers auto-identified</div><div class="task-meta">Agent has pre-negotiated prices with 2 alternates ‚Ä¢ Awaiting your approval to switch</div></div>
              <span class="task-badge badge-urgent">Decide</span>
            </div>
            <div class="task-item">
              <div class="task-priority medium"></div>
              <div class="task-content"><div class="task-title">Price negotiation: Secured 4% discount on bulk citrus order from Riverina grower</div><div class="task-meta">Negotiated within pre-set parameters ‚Ä¢ Annual saving: ~$18K</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">New supplier onboarded: Artisan cheese maker in Hunter Valley ‚Äî passed quality screening</div><div class="task-meta">Matches your premium local sourcing strategy ‚Ä¢ First order scheduled next week</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Compliance View -->
      <div id="view-compliance" style="display:none;">
        <div class="dash-grid" style="grid-template-columns: repeat(3, 1fr);">
          <div class="stat-card green">
            <div class="stat-label">Compliance Score</div>
            <div class="stat-value">99.2%</div>
            <div class="stat-change up">All stores passing</div>
          </div>
          <div class="stat-card gold">
            <div class="stat-label">Auto-Audits Today</div>
            <div class="stat-value">152</div>
            <div class="stat-change up">Temperature, hygiene, expiry</div>
          </div>
          <div class="stat-card red">
            <div class="stat-label">Active Incidents</div>
            <div class="stat-value">1</div>
            <div class="stat-change down">Redfern cold room (resolving)</div>
          </div>
        </div>

        <div class="alert-banner">
          <span class="alert-icon">üå°Ô∏è</span>
          <div class="alert-content">
            <h4>Cold Room Incident ‚Äî Redfern Store, Unit #2</h4>
            <p>Temperature reached 6.2¬∞C at 8:14am (threshold: 5¬∞C). Agent auto-adjusted compressor and notified store manager. Current temp: 4.8¬∞C and falling. Full log available.</p>
          </div>
          <div class="alert-actions">
            <button class="btn btn-primary">View Full Log</button>
          </div>
        </div>

        <div class="panel">
          <div class="panel-header"><span class="panel-title">üìã Compliance Agent ‚Äî Today's Automated Checks</span></div>
          <div class="panel-body">
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">Morning temperature audit: 38/38 stores within range (except Redfern Unit #2 ‚Äî now resolving)</div><div class="task-meta">6:00am automated sweep ‚Ä¢ All cold rooms, display fridges, freezers checked</div></div>
              <span class="task-badge badge-auto">Pass</span>
            </div>
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">Supplier certification check: 3 certifications expiring within 30 days ‚Äî renewal reminders sent</div><div class="task-meta">Organic cert (2 suppliers), food safety cert (1 supplier)</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">Expiry date scan: 18 items flagged across 5 stores for removal by end of day</div><div class="task-meta">Automatically routed to Waste Agent for markdown/donation</div></div>
              <span class="task-badge badge-auto">Auto</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tasks View -->
      <div id="view-tasks" style="display:none;">
        <div class="panel">
          <div class="panel-header">
            <span class="panel-title">üìã Pending Human Review Queue</span>
            <span style="font-size: 11px; color: var(--muted);">Items the agents have escalated for your decision</span>
          </div>
          <div class="panel-body">
            <div class="task-item">
              <div class="task-priority high"></div>
              <div class="task-content"><div class="task-title">Approve backup berry supplier switch (QLD shortage)</div><div class="task-meta">Supplier Agent ‚Ä¢ Impact: $12K order ‚Ä¢ 2 options presented</div></div>
              <span class="task-badge badge-urgent">Urgent</span>
            </div>
            <div class="task-item">
              <div class="task-priority high"></div>
              <div class="task-content"><div class="task-title">Confirm Amazon fulfilment overflow to Leichhardt store</div><div class="task-meta">Fulfilment Agent ‚Ä¢ Capacity at 92% ‚Ä¢ Recommendation: Activate backup</div></div>
              <span class="task-badge badge-urgent">Urgent</span>
            </div>
            <div class="task-item">
              <div class="task-priority medium"></div>
              <div class="task-content"><div class="task-title">Review avocado order increase (+420kg) based on social trend detection</div><div class="task-meta">Forecasting Agent ‚Ä¢ Confidence: 82% ‚Ä¢ Potential upside: $8K</div></div>
              <span class="task-badge badge-pending">Review</span>
            </div>
            <div class="task-item">
              <div class="task-priority medium"></div>
              <div class="task-content"><div class="task-title">Confirm 2 casual staff additions for Miranda Saturday peak</div><div class="task-meta">Workforce Agent ‚Ä¢ Cost: $640 ‚Ä¢ Projected revenue uplift: $3,200</div></div>
              <span class="task-badge badge-pending">Review</span>
            </div>
            <div class="task-item">
              <div class="task-priority low"></div>
              <div class="task-content"><div class="task-title">Approve new artisan cheese supplier onboarding (Hunter Valley)</div><div class="task-meta">Supplier Agent ‚Ä¢ Passed quality check ‚Ä¢ First order: $2,400</div></div>
              <span class="task-badge badge-pending">Review</span>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  // View switching
  function showView(view) {
    const views = ['dashboard', 'agent', 'waste', 'scheduling', 'supplier', 'compliance', 'tasks'];
    views.forEach(v => {
      const el = document.getElementById('view-' + v);
      if (el) el.style.display = v === view ? 'block' : 'none';
    });

    const titles = {
      dashboard: 'Store Operations Dashboard',
      agent: 'Agent Chat',
      waste: 'Waste Reduction Agent',
      scheduling: 'Workforce Scheduling Agent',
      supplier: 'Supplier Management Agent',
      compliance: 'Quality & Compliance Agent',
      tasks: 'Task Review Queue'
    };
    document.getElementById('view-title').textContent = titles[view] || 'Dashboard';

    // Update active nav
    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
    const navItems = document.querySelectorAll('.nav-item');
    const viewIndex = { dashboard: 0, tasks: 1, agent: 2, waste: 3, scheduling: 4, supplier: 5, compliance: 6 };
    if (viewIndex[view] !== undefined && navItems[viewIndex[view]]) {
      navItems[viewIndex[view]].classList.add('active');
    }
  }

  // Chat functionality
  const agentResponses = {
    'waste': "Here's today's waste reduction summary across all 38 stores:\n\n‚Ä¢ Total waste prevented: $4,230 (‚Üë18% vs. daily avg)\n‚Ä¢ Auto-markdowns executed: 127 items across 14 stores\n‚Ä¢ Imperfect Picks routed: 84kg (above 65kg target)\n‚Ä¢ Charity donations: 28kg to OzHarvest\n‚Ä¢ Top performing store: Miranda (92% recovery rate)\n\nThe Waste Agent has also proactively adjusted tomorrow's orders at 6 stores where current shelf-life models predict excess inventory.",
    'staffing': "Weekend staffing analysis across all stores:\n\nüî¥ Miranda: Under by 2 FTEs for Saturday (40% traffic spike predicted). I've matched 4 available casuals ‚Äî shall I confirm 2?\n\nüü° Marrickville: Marginal for Sunday ‚Äî 1 additional staff recommended for deli section.\n\nüü¢ All other stores: Adequately rostered for predicted weekend traffic.\n\nI've already auto-approved 3 shift swaps that improve coverage without additional cost.",
    'supplier': "Current supplier orders requiring attention:\n\n‚ö†Ô∏è Priority: QLD berry supplier (Sunshine Berries) reporting 15% crop loss from storms. I've identified 3 alternatives:\n1. Berry Fresh (NSW) ‚Äî available, +6% cost\n2. Tropical Harvest (QLD) ‚Äî partial fill, same cost\n3. Mixed sourcing ‚Äî split between both, +3% cost\n\nRecommendation: Option 3 (mixed sourcing) for best balance of cost and reliability. Shall I proceed?\n\n‚úÖ All other supplier orders on track. 34 POs auto-generated today totalling $142K.",
    'briefing': "üìã Morning Leadership Briefing ‚Äî 15 Feb 2026\n\nüü¢ Overall Health: Strong\n‚Ä¢ Revenue yesterday: $2.14M (+4% vs. same day last year)\n‚Ä¢ 47 tasks auto-completed by agents this morning\n‚Ä¢ All 38 stores operational, compliance at 99.2%\n\n‚ö†Ô∏è Watch Items:\n‚Ä¢ Amazon fulfilment at 92% capacity ‚Äî backup activation recommended\n‚Ä¢ QLD berry supply disruption ‚Äî alternate suppliers identified\n‚Ä¢ Redfern cold room temp incident ‚Äî auto-resolved, monitoring\n\nüìà Wins:\n‚Ä¢ Waste Agent saved $18.4K this week (‚Üë12% vs. target)\n‚Ä¢ Workforce optimisation score hit 94% (was 78% pre-agent)\n‚Ä¢ New artisan cheese supplier passed screening",
    'amazon': "Amazon fulfilment performance today:\n\nüì¶ Orders processed: 287 (‚Üë22% vs. last Saturday)\nüìç Suburbs covered: 80 Sydney suburbs\n‚è±Ô∏è Avg fulfilment time: 47 minutes (target: 60 min)\n‚úÖ Picking accuracy: 99.3%\n\n‚ö†Ô∏è Capacity concern: Currently at 92%. If order volume increases another 10%, I recommend activating Leichhardt as overflow fulfilment point. Shall I prepare the activation?",
    'default': "I've checked across all connected systems. Here's what I found:\n\nThe agents are operating normally across all 38 stores. Key metrics are tracking above target. I have 3 items in the escalation queue that need your review ‚Äî would you like me to walk through them, or would you prefer to focus on a specific area?"
  };

  function sendMessage() {
    const input = document.getElementById('chatInput');
    const text = input.value.trim();
    if (!text) return;

    const messages = document.getElementById('chatMessages');

    // User message
    const userMsg = document.createElement('div');
    userMsg.className = 'chat-msg';
    userMsg.innerHTML = `<div class="chat-avatar user">AH</div><div class="chat-bubble">${text}</div>`;
    messages.appendChild(userMsg);
    input.value = '';

    // Typing indicator
    const typing = document.createElement('div');
    typing.className = 'chat-msg';
    typing.id = 'typing';
    typing.innerHTML = `<div class="chat-avatar agent">AI</div><div class="chat-bubble agent"><span class="typing-dots"><span>‚óè</span><span>‚óè</span><span>‚óè</span></span></div>`;
    messages.appendChild(typing);
    messages.scrollTop = messages.scrollHeight;

    // Determine response
    const lower = text.toLowerCase();
    let responseKey = 'default';
    if (lower.includes('waste') || lower.includes('markdown') || lower.includes('expir')) responseKey = 'waste';
    else if (lower.includes('staff') || lower.includes('schedul') || lower.includes('roster') || lower.includes('workforce') || lower.includes('weekend')) responseKey = 'staffing';
    else if (lower.includes('supplier') || lower.includes('order') || lower.includes('procurement')) responseKey = 'supplier';
    else if (lower.includes('brief') || lower.includes('leadership') || lower.includes('morning') || lower.includes('summary')) responseKey = 'briefing';
    else if (lower.includes('amazon') || lower.includes('fulfilment') || lower.includes('fulfillment') || lower.includes('online')) responseKey = 'amazon';

    setTimeout(() => {
      typing.remove();
      const agentMsg = document.createElement('div');
      agentMsg.className = 'chat-msg';
      agentMsg.innerHTML = `<div class="chat-avatar agent">AI</div><div class="chat-bubble agent" style="white-space: pre-line;">${agentResponses[responseKey]}</div>`;
      messages.appendChild(agentMsg);
      messages.scrollTop = messages.scrollHeight;
    }, 1500);
  }

  function askPreset(text) {
    showView('agent');
    document.getElementById('chatInput').value = text;
    sendMessage();
  }

  function dismissAlert(btn) {
    btn.closest('.alert-banner').style.display = 'none';
  }

  function updateStore() {
    // Simulate store-specific data
    const store = document.getElementById('storeSelect').value;
    if (store !== 'All Stores (38)') {
      document.getElementById('stat-tasks').textContent = Math.floor(Math.random() * 15 + 5);
      document.getElementById('stat-waste').textContent = '$' + (Math.random() * 3 + 0.5).toFixed(1) + 'K';
      document.getElementById('stat-escalations').textContent = Math.floor(Math.random() * 3);
    } else {
      document.getElementById('stat-tasks').textContent = '47';
      document.getElementById('stat-waste').textContent = '$18.4K';
      document.getElementById('stat-escalations').textContent = '3';
    }
  }

  function refreshData() {
    const btn = event.target;
    btn.textContent = '‚Üª Refreshing...';
    setTimeout(() => { btn.textContent = '‚Üª Refresh'; }, 1000);
  }
</script>
</body>
</html>
